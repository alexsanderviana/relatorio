<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Gerador Yukaline - Din√¢mico</title>
    <style>
        :root {
            --azul-yuk: #003fa0;
            --amarelo-yuk: #f7bd31;
            --amarelo-claro: #fff9eb;
        }

        body { font-family: 'Segoe UI', sans-serif; display: flex; margin: 0; background: #1a1a1a; height: 100vh; }

        /* Painel de Edi√ß√£o */
        #editor {
            width: 400px;
            background: #f4f4f4;
            padding: 20px;
            overflow-y: auto;
            border-right: 2px solid var(--amarelo-yuk);
            box-shadow: 5px 0 15px rgba(0,0,0,0.5);
            z-index: 100;
        }

        /* √Årea de Visualiza√ß√£o */
        #preview-container {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            justify-content: center;
            background: #333;
        }

        #documento-pdf {
            width: 210mm;
            min-height: 297mm;
            background: white;
            padding: 15mm;
            box-sizing: border-box;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }

        .form-group { margin-bottom: 15px; position: relative; background: #eee; padding: 10px; border-radius: 5px; }
        label { display: block; font-weight: bold; font-size: 11px; color: var(--azul-yuk); text-transform: uppercase; margin-bottom: 4px; }
        input, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 13px; box-sizing: border-box; }
        
        .btn-add {
            width: 100%;
            padding: 10px;
            background: var(--azul-yuk);
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 15px;
        }

        .btn-gerar {
            width: 100%;
            padding: 15px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }

        .btn-remover {
            background: #c0392b;
            color: white;
            border: none;
            padding: 2px 8px;
            font-size: 10px;
            border-radius: 3px;
            cursor: pointer;
            position: absolute;
            right: 10px;
            top: 10px;
        }

        /* Estilos do PDF */
        header { display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid var(--azul-yuk); padding-bottom: 10px; margin-bottom: 15px; }
        .logo-img { max-height: 55px; }
        h1 { color: var(--azul-yuk); margin: 0; font-size: 20px; text-transform: uppercase; }
        
        h2 { background: var(--azul-yuk); color: white; padding: 6px 12px; font-size: 13px; border-left: 5px solid var(--amarelo-yuk); margin: 15px 0 5px 0; display: flex; justify-content: space-between; align-items: center; }
        
        .total-cabo { font-size: 11px; background: var(--amarelo-yuk); color: #000; padding: 2px 8px; border-radius: 4px; font-weight: bold; }
        
        table { width: 100%; border-collapse: collapse; margin-bottom: 5px; }
        th { background: var(--amarelo-claro); color: var(--azul-yuk); padding: 6px; text-align: left; border-bottom: 2px solid var(--azul-yuk); font-size: 11px; }
        td { padding: 6px; border-bottom: 1px solid #eee; font-size: 11px; }
        
        .fiber-badge { font-weight: bold; color: var(--azul-yuk); }

        .resumo-geral {
            margin-top: 25px;
            background: #f9f9f9;
            border: 2px solid var(--azul-yuk);
            padding: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .assinatura {
            margin-top: 40px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .linha { width: 250px; border-top: 1px solid #333; margin-top: 30px; padding-top: 5px; font-size: 12px; }

        @media print {
            #editor { display: none !important; }
            #preview-container { padding: 0; background: white; overflow: visible; }
            body { background: white; }
            #documento-pdf { width: 100%; border: none; padding: 0; box-shadow: none; }
            h2, th, .total-cabo { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
</head>
<body>

    <div id="editor">
        <h3 style="color: var(--azul-yuk); margin-top: 0;">Engenharia Yukaline</h3>
        
        <div class="form-group" style="background:none; padding:0">
            <label>T√≠tulo do Relat√≥rio</label>
            <input type="text" id="in-titulo" value="RELAT√ìRIO DE DERIVA√á√ïES" oninput="atualizar()">
        </div>

        <div class="form-group" style="background:none; padding:0">
            <label>Projetista Respons√°vel</label>
            <input type="text" id="in-projetista" placeholder="Nome do Respons√°vel" oninput="atualizar()">
        </div>

        <div class="form-group" style="background:none; padding:0">
            <label>Identifica√ß√£o da CE</label>
            <input type="text" id="in-ce" value="CE YUK 22" oninput="atualizar()">
        </div>

        <hr style="border:0; border-top: 1px solid #ccc; margin: 15px 0;">
        
        <button class="btn-add" onclick="adicionarCabo()">+ ADICIONAR NOVO CABO</button>

        <div id="container-inputs-cabos">
            </div>

        <button class="btn-gerar" onclick="window.print()">üñ®Ô∏è GERAR PDF</button>
    </div>

    <div id="preview-container">
        <div id="documento-pdf">
            <header>
                <div>
                    <h1 id="out-titulo">RELAT√ìRIO DE DERIVA√á√ïES</h1>
                    <p style="margin:4px 0">CE: <strong id="out-ce">CE YUK 22</strong></p>
                    <p style="margin:2px 0; font-size: 11px; color: #555;">Projetista: <span id="out-projetista">---</span></p>
                </div>
                <img src="https://i.ibb.co/zHQ0hmhk/Logo.png" alt="Yukaline" class="logo-img">
            </header>

            <div id="conteudo-pdf"></div>

            <div class="resumo-geral">
                <div>
                    <strong style="color: var(--azul-yuk); font-size: 14px;">CAPACIDADE TOTAL DA CE</strong><br>
                    <span style="font-size: 11px; color: #666;">Total de portas ativas em todas as deriva√ß√µes</span>
                </div>
                <div style="text-align: right;">
                    <span style="font-size: 24px; font-weight: bold; color: var(--azul-yuk);" id="total-geral">0</span>
                    <span style="font-size: 14px; font-weight: bold; color: var(--azul-yuk);"> PORTAS</span>
                </div>
            </div>

            <div class="assinatura">
                <div class="linha">
                    <strong id="out-assinatura">Assinatura do Projetista</strong><br>
                    Setor de Engenharia - Yukaline Internet
                </div>
            </div>
        </div>
    </div>

    <script>
        let contadorCabos = 0;

        function adicionarCabo(titulo = "", texto = "") {
            contadorCabos++;
            const id = contadorCabos;
            const div = document.createElement('div');
            div.className = 'form-group';
            div.id = `input-bloco-${id}`;
            div.innerHTML = `
                <button class="btn-remover" onclick="removerCabo(${id})">X Remover</button>
                <label>T√≠tulo do Cabo</label>
                <input type="text" class="cabo-titulo" placeholder="Cabo ${id}: 12FO..." value="${titulo}" oninput="atualizar()">
                <label style="margin-top:8px">Descri√ß√£o (Fibra -> Descri√ß√£o)</label>
                <textarea class="cabo-texto" rows="3" oninput="atualizar()">${texto}</textarea>
            `;
            document.getElementById('container-inputs-cabos').appendChild(div);
            atualizar();
        }

        function removerCabo(id) {
            const el = document.getElementById(`input-bloco-${id}`);
            el.remove();
            atualizar();
        }

        function extrairSoma(texto) {
            const regex = /(\d+)\s*(portas|porta|pt|p|PORTAS)?/gi;
            let total = 0;
            let match;
            while ((match = regex.exec(texto)) !== null) {
                total += parseInt(match[1]);
            }
            return total;
        }

        function atualizar() {
            // Cabe√ßalho
            document.getElementById('out-titulo').innerText = document.getElementById('in-titulo').value;
            document.getElementById('out-ce').innerText = document.getElementById('in-ce').value;
            const proj = document.getElementById('in-projetista').value || "---";
            document.getElementById('out-projetista').innerText = proj;
            document.getElementById('out-assinatura').innerText = proj;

            // Processar Cabos
            const titulos = document.getElementsByClassName('cabo-titulo');
            const textos = document.getElementsByClassName('cabo-texto');
            
            let htmlFinal = '';
            let somaGeral = 0;

            for (let i = 0; i < titulos.length; i++) {
                const tituloVal = titulos[i].value || `CABO ${i+1}`;
                const textoVal = textos[i].value;
                
                let somaCabo = 0;
                let linhasTabela = '';
                
                textoVal.split('\n').forEach(linha => {
                    if(linha.trim()){
                        somaCabo += extrairSoma(linha);
                        const partes = linha.split('->');
                        const fibra = partes[0] ? partes[0].trim() : '-';
                        const desc = partes[1] ? partes[1].trim() : linha;
                        linhasTabela += `<tr><td width="15%"><span class="fiber-badge">${fibra}</span></td><td>${desc}</td></tr>`;
                    }
                });

                somaGeral += somaCabo;

                htmlFinal += `
                    <h2>
                        <span>${tituloVal}</span>
                        <span class="total-cabo">${somaCabo} PORTAS</span>
                    </h2>
                    <table>
                        <thead><tr><th>Fibra</th><th>Descri√ß√£o Detalhada</th></tr></thead>
                        <tbody>${linhasTabela || '<tr><td colspan="2">Nenhuma deriva√ß√£o informada</td></tr>'}</tbody>
                    </table>`;
            }

            document.getElementById('conteudo-pdf').innerHTML = htmlFinal;
            document.getElementById('total-geral').innerText = somaGeral;
        }

        // Iniciar com alguns cabos de exemplo
        window.onload = () => {
            adicionarCabo("CABO 1: 12FO [CE 22 - CE 22-B]", "F2 -> F01_N - 16 PORTAS\nF3 -> F07_N - 4 PORTAS");
            adicionarCabo("CABO 2: 6FO [CE 22 - CE 148]", "F1 -> F23_N - 32 PORTAS\nF2 -> F19_N - 16 PORTAS");
        };
    </script>
</body>
</html>15:52 29/12/2025